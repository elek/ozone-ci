2019-09-24 16:09:59,237 INFO  util.LogUtils (LogUtils.java:setLogLevel(41)) - Set org.apache.ratis.server.impl.RaftServerImpl log level to DEBUG
2019-09-24 16:09:59,240 INFO  util.LogUtils (LogUtils.java:setLogLevel(41)) - Set org.apache.ratis.client.RaftClient log level to DEBUG
2019-09-24 16:09:59,241 INFO  util.LogUtils (LogUtils.java:setLogLevel(41)) - Set org.apache.ratis.server.impl.PendingRequests log level to DEBUG
2019-09-24 16:09:59,243 INFO  util.LogUtils (LogUtils.java:setLogLevel(41)) - Set org.apache.ratis.conf.ConfUtils log level to WARN
2019-09-24 16:09:59,244 INFO  util.LogUtils (LogUtils.java:setLogLevel(41)) - Set org.apache.ratis.util.FileUtils log level to TRACE
2019-09-24 16:09:59,278 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:runWithSameCluster(137)) - Running testWriteElementLimit
2019-09-24 16:09:59,366 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:<init>(253)) - new MiniRaftClusterWithGrpc with group-6F23216343BB:[s0:0.0.0.0:43547]
2019-09-24 16:09:59,367 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:start(287)) - .............................................................. 
2019-09-24 16:09:59,367 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:start(288)) - ... 
2019-09-24 16:09:59,367 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:start(289)) - ...     Starting MiniRaftClusterWithGrpc
2019-09-24 16:09:59,367 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:start(290)) - ... 
2019-09-24 16:09:59,367 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:start(291)) - .............................................................. 
2019-09-24 16:09:59,368 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:initServers(265)) - servers = {}
2019-09-24 16:09:59,378 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(330)) - newRaftServer: s0, group-6F23216343BB:[s0:0.0.0.0:43547], format? true
2019-09-24 16:09:59,381 TRACE util.FileUtils (FileUtils.java:deleteFully(88)) - deleteFully target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0
2019-09-24 16:09:59,388 TRACE util.FileUtils (FileUtils.java:deleteFully(104)) - deleteFully: target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0 does not exist.
2019-09-24 16:09:59,390 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:newRaftServer(335)) - Formatted directory target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0
2019-09-24 16:09:59,406 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-09-24 16:09:59,477 INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(45)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2019-09-24 16:09:59,480 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43547 (custom)
2019-09-24 16:09:59,483 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 64MB (=67108864) (default)
2019-09-24 16:09:59,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2019-09-24 16:09:59,487 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-09-24 16:09:59,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 5s (custom)
2019-09-24 16:09:59,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0] (custom)
2019-09-24 16:09:59,671 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - s0: addNew group-6F23216343BB:[s0:0.0.0.0:43547] returns group-6F23216343BB:java.util.concurrent.CompletableFuture@3799fb0b[Not completed]
2019-09-24 16:09:59,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2019-09-24 16:09:59,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2019-09-24 16:09:59,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2019-09-24 16:09:59,689 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - s0: new RaftServerImpl for group-6F23216343BB:[s0:0.0.0.0:43547] with SimpleStateMachine4Testing:uninitialized
2019-09-24 16:09:59,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 150ms (default)
2019-09-24 16:09:59,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 300ms (default)
2019-09-24 16:09:59,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 60s (default)
2019-09-24 16:09:59,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-09-24 16:09:59,695 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-09-24 16:09:59,704 INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - s0@group-6F23216343BB: ConfigurationManager, init=-1: [s0:0.0.0.0:43547], old=null, confs=<EMPTY_MAP>
2019-09-24 16:09:59,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0] (custom)
2019-09-24 16:09:59,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-09-24 16:09:59,717 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb does not exist. Creating ...
2019-09-24 16:09:59,720 TRACE util.FileUtils (LogUtils.java:runAndLog(61)) - Successfully ran Files.createDirectories /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb
2019-09-24 16:09:59,762 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb/in_use.lock acquired by nodename 6855@ratis-test-vphbd-3564017154
2019-09-24 16:09:59,763 TRACE util.FileUtils (LogUtils.java:runAndLog(61)) - Successfully ran Files.createDirectories /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb/current
2019-09-24 16:09:59,763 TRACE util.FileUtils (LogUtils.java:runAndLog(61)) - Successfully ran Files.createDirectories /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb/sm
2019-09-24 16:09:59,788 INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb has been successfully formatted.
2019-09-24 16:09:59,789 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:initialize(206)) - Initializing SimpleStateMachine4Testing:uninitialized
2019-09-24 16:09:59,795 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:loadSnapshot(296)) - The snapshot file null does not exist
2019-09-24 16:09:59,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 60s (default)
2019-09-24 16:09:59,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-09-24 16:09:59,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1024 (default)
2019-09-24 16:09:59,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 4MB (=4194304) (default)
2019-09-24 16:09:59,812 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2019-09-24 16:09:59,818 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 6 (default)
2019-09-24 16:09:59,825 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(172)) - new s0@group-6F23216343BB-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb
2019-09-24 16:09:59,911 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(124)) - Cannot locate configuration: tried hadoop-metrics2-ratis.properties,hadoop-metrics2.properties
2019-09-24 16:10:00,035 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(376)) - Scheduled snapshot period at 10 second(s).
2019-09-24 16:10:00,036 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - ratis metrics system started
2019-09-24 16:10:00,042 INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2019-09-24 16:10:00,077 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2019-09-24 16:10:00,078 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 4096 (default)
2019-09-24 16:10:00,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 8MB (=8388608) (default)
2019-09-24 16:10:00,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 4MB (=4194304) (default)
2019-09-24 16:10:00,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2019-09-24 16:10:00,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-09-24 16:10:00,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-09-24 16:10:00,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-09-24 16:10:00,084 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-09-24 16:10:00,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2019-09-24 16:10:00,097 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(132)) - s0@group-6F23216343BB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-09-24 16:10:00,102 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = false (default)
2019-09-24 16:10:00,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = -1 (default)
2019-09-24 16:10:00,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 60s (default)
2019-09-24 16:10:00,130 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - s0@group-6F23216343BB: start as a follower, conf=-1: [s0:0.0.0.0:43547], old=null
2019-09-24 16:10:00,133 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - s0@group-6F23216343BB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-09-24 16:10:00,135 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - s0: start FollowerState
2019-09-24 16:10:00,138 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6F23216343BB,id=s0
2019-09-24 16:10:00,151 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - s0: start RPC server
2019-09-24 16:10:00,283 INFO  server.GrpcService (GrpcService.java:startImpl(158)) - s0: GrpcService started, listening on 0.0.0.0/0.0.0.0:43547
2019-09-24 16:10:00,286 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 300ms (default)
2019-09-24 16:10:00,289 INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(86)) - printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-6F23216343BB:t0, leader=null, voted=null, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [s0:0.0.0.0:43547], old=null RUNNING
2019-09-24 16:10:00,293 WARN  ratis.RaftTestUtil (JavaUtils.java:attempt(158)) - FAILED "waitForLeader-null-(expectLeader? true)", attempt #1/100: java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-6F23216343BB:t0, leader=null, voted=null, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [s0:0.0.0.0:43547], old=null RUNNING, sleep 450ms and then retry.
java.lang.IllegalStateException: No leader yet : printing ALL groups
  s0:  RUNNING  FOLLOWER s0@group-6F23216343BB:t0, leader=null, voted=null, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [s0:0.0.0.0:43547], old=null RUNNING
	at org.apache.ratis.MiniRaftCluster.newIllegalStateExceptionForNoLeaders(MiniRaftCluster.java:506)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$1(RaftTestUtil.java:90)
	at org.apache.ratis.MiniRaftCluster.getLeader(MiniRaftCluster.java:539)
	at org.apache.ratis.MiniRaftCluster.getLeader(MiniRaftCluster.java:532)
	at org.apache.ratis.RaftTestUtil.lambda$waitForLeader$3(RaftTestUtil.java:98)
	at org.apache.ratis.util.JavaUtils.attempt(JavaUtils.java:152)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:97)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:77)
	at org.apache.ratis.RaftTestUtil.waitForLeader(RaftTestUtil.java:72)
	at org.apache.ratis.RequestLimitAsyncBaseTest.runTestWriteElementLimit(RequestLimitAsyncBaseTest.java:69)
	at org.apache.ratis.MiniRaftCluster$Factory$Get.runWithSameCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.RequestLimitAsyncBaseTest.testWriteElementLimit(RequestLimitAsyncBaseTest.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:00,361 INFO  impl.FollowerState (FollowerState.java:run(108)) - s0@group-6F23216343BB-FollowerState: change to CANDIDATE, lastRpcTime:226ms, electionTimeout:225ms
2019-09-24 16:10:00,365 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - s0: shutdown FollowerState
2019-09-24 16:10:00,366 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - s0@group-6F23216343BB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-09-24 16:10:00,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - s0: start LeaderElection
2019-09-24 16:10:00,386 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - s0@group-6F23216343BB-LeaderElection1: begin an election at term 1 for -1: [s0:0.0.0.0:43547], old=null
2019-09-24 16:10:00,389 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - s0: shutdown LeaderElection
2019-09-24 16:10:00,391 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - s0@group-6F23216343BB: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-09-24 16:10:00,391 INFO  impl.RaftServerImpl (ServerState.java:setLeader(254)) - s0@group-6F23216343BB: change Leader from null to s0 at term 1 for becomeLeader, leader elected after 595ms
2019-09-24 16:10:00,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-09-24 16:10:00,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-09-24 16:10:00,403 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 5 (custom)
2019-09-24 16:10:00,409 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-09-24 16:10:00,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-09-24 16:10:00,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 2 (custom)
2019-09-24 16:10:00,431 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - s0: start LeaderState
2019-09-24 16:10:00,459 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(380)) - s0@group-6F23216343BB-SegmentedRaftLogWorker: Starting segment from index:0
2019-09-24 16:10:00,480 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(355)) - s0@group-6F23216343BB: set configuration 0: [s0:0.0.0.0:43547], old=null at 0
2019-09-24 16:10:00,747 INFO  ratis.RaftTestUtil (RaftTestUtil.java:waitForLeader(101)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-6F23216343BB:t1, leader=s0, voted=s0, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=0: [s0:0.0.0.0:43547], old=null RUNNING
2019-09-24 16:10:00,753 DEBUG client.RaftClient (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-09-24 16:10:00,889 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(569)) - s0@group-6F23216343BB-SegmentedRaftLogWorker: created new log segment /workdir/ratis-test/target/test/data/15d6bd09/MiniRaftClusterWithGrpcef89cc78/s0/b84f5be4-53fa-4932-9a92-6f23216343bb/current/log_inprogress_0
2019-09-24 16:10:01,270 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374)
2019-09-24 16:10:01,321 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, first with org.apache.ratis.protocol.LeaderNotReadyException: s0@group-6F23216343BB is in LEADER state but not ready yet.
2019-09-24 16:10:01,424 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, first with org.apache.ratis.protocol.AlreadyClosedException: client-9AB70352AF3B->s0 is closed.
2019-09-24 16:10:01,425 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:01,546 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374)
2019-09-24 16:10:01,579 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374, entry=(t:1, i:1), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=0
2019-09-24 16:10:01,579 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=1, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374
2019-09-24 16:10:01,580 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 1 -> PendingRequest(index=1, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374
2019-09-24 16:10:02,078 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 1 returns PendingRequest(index=1, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374
2019-09-24 16:10:02,079 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 1, first -> (t:1, i:1), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=0
2019-09-24 16:10:02,085 DEBUG impl.PendingRequests (PendingRequests.java:remove(103)) - s0@group-6F23216343BB: PendingRequests.remove 1 returns PendingRequest(index=1, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=0, seq=1*, RW, Message:6669727374
2019-09-24 16:10:02,094 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, Message:6d30)
2019-09-24 16:10:02,095 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, Message:6d30, entry=(t:1, i:3), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=1
2019-09-24 16:10:02,095 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=3, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, Message:6d30
2019-09-24 16:10:02,095 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 3 -> PendingRequest(index=3, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, Message:6d30
2019-09-24 16:10:02,096 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, Message:6d31)
2019-09-24 16:10:02,097 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, Message:6d31, entry=(t:1, i:4), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=2
2019-09-24 16:10:02,098 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=4, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, Message:6d31
2019-09-24 16:10:02,098 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 4 -> PendingRequest(index=4, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, Message:6d31
2019-09-24 16:10:02,100 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, Message:6d32)
2019-09-24 16:10:02,101 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, Message:6d32, entry=(t:1, i:5), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=3
2019-09-24 16:10:02,101 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=5, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, Message:6d32
2019-09-24 16:10:02,101 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 5 -> PendingRequest(index=5, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, Message:6d32
2019-09-24 16:10:02,102 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, Message:6d33)
2019-09-24 16:10:02,103 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, Message:6d33, entry=(t:1, i:6), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=4
2019-09-24 16:10:02,103 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=6, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, Message:6d33
2019-09-24 16:10:02,104 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 6 -> PendingRequest(index=6, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, Message:6d33
2019-09-24 16:10:02,105 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, Message:6d34)
2019-09-24 16:10:02,106 DEBUG impl.RaftServerImpl (LeaderState.java:addPendingRequest(317)) - s0@group-6F23216343BB-LeaderState: addPendingRequest at RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, Message:6d34, entry=(t:1, i:7), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=5
2019-09-24 16:10:02,106 DEBUG impl.PendingRequests (PendingRequests.java:add(151)) - s0@group-6F23216343BB-PendingRequests: addPendingRequest at index=7, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, Message:6d34
2019-09-24 16:10:02,106 DEBUG impl.PendingRequests (PendingRequests.java:put(84)) - s0@group-6F23216343BB: PendingRequests.put 7 -> PendingRequest(index=7, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, Message:6d34
2019-09-24 16:10:02,108 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>)
2019-09-24 16:10:02,109 DEBUG impl.RaftServerImpl (LeaderState.java:addWatchReqeust(324)) - s0@group-6F23216343BB-LeaderState: addWatchRequest RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>
2019-09-24 16:10:02,116 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), Message:<EMPTY>)
2019-09-24 16:10:02,116 DEBUG impl.RaftServerImpl (LeaderState.java:addWatchReqeust(324)) - s0@group-6F23216343BB-LeaderState: addWatchRequest RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), Message:<EMPTY>
2019-09-24 16:10:02,209 DEBUG client.RaftClient (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-09-24 16:10:02,210 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:testFailureCase(123)) - run 'send should fail'
2019-09-24 16:10:02,212 DEBUG client.RaftClient (RaftClientImpl.java:sendRequest(275)) - client-1F6BCCA1EBEB: send RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=8, seq=0, RW, err
2019-09-24 16:10:02,233 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=8, seq=0, RW, Message:657272)
2019-09-24 16:10:02,285 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-1F6BCCA1EBEB: suggested new leader: null. Failed RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=8, seq=0, RW, err with org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s0@group-6F23216343BB: Failed to acquire a pending write request for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=8, seq=0, RW, Message:657272
2019-09-24 16:10:02,286 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-1F6BCCA1EBEB: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:02,286 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:assertThrowable(105)) - The test "send should fail" throws ResourceUnavailableException
org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s0@group-6F23216343BB: Failed to acquire a pending write request for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=8, seq=0, RW, Message:657272
	at org.apache.ratis.server.impl.RaftServerImpl.appendTransaction(RaftServerImpl.java:502)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:576)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327)
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:220)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$UnorderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:276)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:240)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:168)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:02,288 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:testFailureCase(123)) - run 'sendAsync should fail'
2019-09-24 16:10:02,292 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=9, seq=1*, RW, Message:657272)
2019-09-24 16:10:02,301 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:assertThrowable(105)) - The test "sendAsync should fail" throws ExecutionException
java.util.concurrent.ExecutionException: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s0@group-6F23216343BB: Failed to acquire a pending write request for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=9, seq=1*, RW, Message:657272
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895)
	at org.apache.ratis.RequestLimitAsyncBaseTest.lambda$runTestWriteElementLimit$1(RequestLimitAsyncBaseTest.java:104)
	at org.apache.ratis.BaseTest.testFailureCase(BaseTest.java:126)
	at org.apache.ratis.BaseTest.testFailureCase(BaseTest.java:139)
	at org.apache.ratis.RequestLimitAsyncBaseTest.runTestWriteElementLimit(RequestLimitAsyncBaseTest.java:104)
	at org.apache.ratis.MiniRaftCluster$Factory$Get.runWithSameCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.RequestLimitAsyncBaseTest.testWriteElementLimit(RequestLimitAsyncBaseTest.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: s0@group-6F23216343BB: Failed to acquire a pending write request for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=9, seq=1*, RW, Message:657272
	at org.apache.ratis.server.impl.RaftServerImpl.appendTransaction(RaftServerImpl.java:502)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:576)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327)
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:220)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:326)
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:429)
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:421)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:345)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:240)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:168)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2019-09-24 16:10:02,303 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:testFailureCase(123)) - run 'sendWatch should fail'
2019-09-24 16:10:02,303 DEBUG client.RaftClient (RaftClientImpl.java:sendRequest(275)) - client-1F6BCCA1EBEB: send RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), null
2019-09-24 16:10:02,306 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), Message:<EMPTY>)
2019-09-24 16:10:02,306 DEBUG impl.RaftServerImpl (LeaderState.java:addWatchReqeust(324)) - s0@group-6F23216343BB-LeaderState: addWatchRequest RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), Message:<EMPTY>
2019-09-24 16:10:02,314 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-1F6BCCA1EBEB: suggested new leader: null. Failed RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), null with org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), Message:<EMPTY>
2019-09-24 16:10:02,314 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-1F6BCCA1EBEB: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:02,315 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:assertThrowable(105)) - The test "sendWatch should fail" throws ResourceUnavailableException
org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=10, seq=0, Watch-ALL(1002), Message:<EMPTY>
	at org.apache.ratis.server.impl.WatchRequests$WatchQueue.add(WatchRequests.java:106)
	at org.apache.ratis.server.impl.WatchRequests.add(WatchRequests.java:192)
	at org.apache.ratis.server.impl.LeaderState.addWatchReqeust(LeaderState.java:325)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$watchAsync$10(RaftServerImpl.java:581)
	at java.util.Optional.map(Optional.java:215)
	at org.apache.ratis.server.impl.RaftServerImpl.watchAsync(RaftServerImpl.java:581)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:553)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327)
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:220)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$UnorderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:276)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:240)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:168)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:02,316 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:testFailureCase(123)) - run 'sendWatchAsync should fail'
2019-09-24 16:10:02,318 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=11, seq=0, Watch-ALL(1002), Message:<EMPTY>)
2019-09-24 16:10:02,318 DEBUG impl.RaftServerImpl (LeaderState.java:addWatchReqeust(324)) - s0@group-6F23216343BB-LeaderState: addWatchRequest RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=11, seq=0, Watch-ALL(1002), Message:<EMPTY>
2019-09-24 16:10:02,325 INFO  grpc.TestRequestLimitAsyncWithGrpc (BaseTest.java:assertThrowable(105)) - The test "sendWatchAsync should fail" throws ExecutionException
java.util.concurrent.ExecutionException: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=11, seq=0, Watch-ALL(1002), Message:<EMPTY>
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895)
	at org.apache.ratis.RequestLimitAsyncBaseTest.lambda$runTestWriteElementLimit$3(RequestLimitAsyncBaseTest.java:111)
	at org.apache.ratis.BaseTest.testFailureCase(BaseTest.java:126)
	at org.apache.ratis.BaseTest.testFailureCase(BaseTest.java:139)
	at org.apache.ratis.RequestLimitAsyncBaseTest.runTestWriteElementLimit(RequestLimitAsyncBaseTest.java:111)
	at org.apache.ratis.MiniRaftCluster$Factory$Get.runWithSameCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.RequestLimitAsyncBaseTest.testWriteElementLimit(RequestLimitAsyncBaseTest.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-1F6BCCA1EBEB->s0@group-6F23216343BB, cid=11, seq=0, Watch-ALL(1002), Message:<EMPTY>
	at org.apache.ratis.server.impl.WatchRequests$WatchQueue.add(WatchRequests.java:106)
	at org.apache.ratis.server.impl.WatchRequests.add(WatchRequests.java:192)
	at org.apache.ratis.server.impl.LeaderState.addWatchReqeust(LeaderState.java:325)
	at org.apache.ratis.server.impl.RaftServerImpl.lambda$watchAsync$10(RaftServerImpl.java:581)
	at java.util.Optional.map(Optional.java:215)
	at org.apache.ratis.server.impl.RaftServerImpl.watchAsync(RaftServerImpl.java:581)
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:553)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328)
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109)
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328)
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981)
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124)
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327)
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:220)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$UnorderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:276)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:240)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:168)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2019-09-24 16:10:02,925 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 3 returns PendingRequest(index=3, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, Message:6d30
2019-09-24 16:10:02,926 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 3, m0 -> (t:1, i:3), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=1
2019-09-24 16:10:02,927 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 4 returns PendingRequest(index=4, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, Message:6d31
2019-09-24 16:10:02,928 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 4, m1 -> (t:1, i:4), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=2
2019-09-24 16:10:02,928 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 5 returns PendingRequest(index=5, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, Message:6d32
2019-09-24 16:10:02,929 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 5, m2 -> (t:1, i:5), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=3
2019-09-24 16:10:02,929 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 6 returns PendingRequest(index=6, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, Message:6d33
2019-09-24 16:10:02,929 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 6, m3 -> (t:1, i:6), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=4
2019-09-24 16:10:02,930 DEBUG impl.PendingRequests (PendingRequests.java:get(97)) - s0@group-6F23216343BB: PendingRequests.get 7 returns PendingRequest(index=7, request=RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, Message:6d34
2019-09-24 16:10:02,930 INFO  statemachine.SimpleStateMachine4Testing (SimpleStateMachine4Testing.java:put(198)) - s0: put 7, m4 -> (t:1, i:7), STATEMACHINELOGENTRY, client-9AB70352AF3B, cid=5
2019-09-24 16:10:07,094 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, m0 with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2, RW, m0
2019-09-24 16:10:07,096 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,097 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, m1 with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=2, seq=3, RW, m1
2019-09-24 16:10:07,097 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,097 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, m2 with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=3, seq=4, RW, m2
2019-09-24 16:10:07,097 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,098 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, m3 with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=4, seq=5, RW, m3
2019-09-24 16:10:07,098 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,098 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, m4 with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=5, seq=6, RW, m4
2019-09-24 16:10:07,098 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,105 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), null with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), null
2019-09-24 16:10:07,105 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,109 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), null with org.apache.ratis.protocol.TimeoutIOException: Request timeout 5s: RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), null
2019-09-24 16:10:07,109 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,211 DEBUG impl.RaftServerImpl (RaftServerImpl.java:submitClientRequestAsync(533)) - s0@group-6F23216343BB: receive client request(RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>)
2019-09-24 16:10:07,212 DEBUG impl.RaftServerImpl (LeaderState.java:addWatchReqeust(324)) - s0@group-6F23216343BB-LeaderState: addWatchRequest RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>
2019-09-24 16:10:07,218 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2*, RW, m0 with java.io.IOException: java.lang.IllegalStateException: Entry already exists for key 2 in map SlidingWindow$Server:1-OrderedRequestStreamObserver1:requests
2019-09-24 16:10:07,219 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,221 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), null with org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>
2019-09-24 16:10:07,222 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), null with org.apache.ratis.protocol.exceptions.ResourceUnavailableException: Failed to acquire a pending watch request in s0@group-6F23216343BB-WatchRequests for RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>
2019-09-24 16:10:07,222 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,223 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,319 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=1, seq=2*, RW, m0 with org.apache.ratis.protocol.AlreadyClosedException: client-9AB70352AF3B->s0 is closed.
2019-09-24 16:10:07,319 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,330 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), null with org.apache.ratis.protocol.AlreadyClosedException: client-9AB70352AF3B->s0: Stream close: no reply for async request cid=6
2019-09-24 16:10:07,331 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(343)) - client-9AB70352AF3B: suggested new leader: null. Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), null with org.apache.ratis.protocol.AlreadyClosedException: client-9AB70352AF3B->s0: Stream close: no reply for async request cid=7
2019-09-24 16:10:07,332 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,332 DEBUG client.RaftClient (RaftClientImpl.java:handleIOException(362)) - client-9AB70352AF3B: oldLeader=s0,  curLeader=s0, newLeader=null
2019-09-24 16:10:07,338 ERROR impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(122)) - client-9AB70352AF3B: XXX Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), null
java.lang.IllegalStateException
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:36)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:124)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:110)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:176)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:119)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:736)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:07,339 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:runWithSameCluster(144)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-6F23216343BB:t1, leader=s0, voted=s0, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c8,f8,i8, conf=0: [s0:0.0.0.0:43547], old=null RUNNING
2019-09-24 16:10:07,338 ERROR impl.UnorderedAsync (UnorderedAsync.java:lambda$sendRequestWithRetry$4(122)) - client-9AB70352AF3B: XXX Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), null
java.lang.IllegalStateException
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:36)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:124)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:110)
	at org.apache.ratis.util.TimeoutScheduler.onTimeout(TimeoutScheduler.java:176)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:119)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:736)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:07,340 ERROR ratis.MiniRaftCluster (MiniRaftCluster.java:runWithSameCluster(146)) - Failed org.apache.ratis.RequestLimitAsyncBaseTest.testWriteElementLimit(RequestLimitAsyncBaseTest.java:65)
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.ratis.BaseTest.getWithDefaultTimeout(BaseTest.java:168)
	at org.apache.ratis.RequestLimitAsyncBaseTest.runTestWriteElementLimit(RequestLimitAsyncBaseTest.java:119)
	at org.apache.ratis.MiniRaftCluster$Factory$Get.runWithSameCluster(MiniRaftCluster.java:141)
	at org.apache.ratis.RequestLimitAsyncBaseTest.testWriteElementLimit(RequestLimitAsyncBaseTest.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)
2019-09-24 16:10:07,369 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(700)) - ************************************************************** 
2019-09-24 16:10:07,369 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(701)) - *** 
2019-09-24 16:10:07,369 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(702)) - ***     Stopping MiniRaftClusterWithGrpc
2019-09-24 16:10:07,370 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(703)) - *** 
2019-09-24 16:10:07,370 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(704)) - ************************************************************** 
2019-09-24 16:10:07,370 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(705)) - printing ALL groups
  s0:  RUNNING    LEADER s0@group-6F23216343BB:t1, leader=s0, voted=s0, raftlog=s0@group-6F23216343BB-SegmentedRaftLog:OPENED:c8,f8,i8, conf=0: [s0:0.0.0.0:43547], old=null RUNNING
2019-09-24 16:10:07,374 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - s0: close
2019-09-24 16:10:07,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - s0@group-6F23216343BB: shutdown
2019-09-24 16:10:07,377 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6F23216343BB,id=s0
2019-09-24 16:10:07,377 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - s0: shutdown LeaderState
2019-09-24 16:10:07,378 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - s0@group-6F23216343BB-PendingRequests: sendNotLeaderResponses
2019-09-24 16:10:07,379 DEBUG impl.PendingRequests (PendingRequests.java:setNotLeaderException(118)) - s0@group-6F23216343BB: PendingRequests.setNotLeaderException
2019-09-24 16:10:07,384 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - s0@group-6F23216343BB-StateMachineUpdater: set stopIndex = 8
2019-09-24 16:10:07,385 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(278)) - Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, seq=0, Watch-ALL(1001), Message:<EMPTY>, reply=RaftClientReply:client-9AB70352AF3B->s0@group-6F23216343BB, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server s0@group-6F23216343BB is not the leader, logIndex=0, commits[s0:c8]
2019-09-24 16:10:07,385 INFO  impl.RaftServerImpl (ServerState.java:close(386)) - s0@group-6F23216343BB: closes. applyIndex: 8
2019-09-24 16:10:07,385 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(278)) - Failed RaftClientRequest:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, seq=0, Watch-ALL(1000), Message:<EMPTY>, reply=RaftClientReply:client-9AB70352AF3B->s0@group-6F23216343BB, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server s0@group-6F23216343BB is not the leader, logIndex=0, commits[s0:c8]
2019-09-24 16:10:07,388 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(313)) - s0@group-6F23216343BB-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-09-24 16:10:07,391 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(228)) - s0@group-6F23216343BB-SegmentedRaftLogWorker close()
2019-09-24 16:10:07,393 INFO  server.GrpcService (GrpcService.java:closeImpl(164)) - s0: shutdown server with port 43547 now
2019-09-24 16:10:07,396 INFO  server.GrpcService (GrpcService.java:closeImpl(172)) - s0: shutdown server with port 43547 successfully
2019-09-24 16:10:07,397 INFO  ratis.MiniRaftCluster (MiniRaftCluster.java:shutdown(722)) - MiniRaftClusterWithGrpc shutdown completed
